var bg_color_img_box="rgba(0,0,0,0.9)",allow_hide_scroll_img_box="yes",use_fade_inout_img_box="yes",speed_img_box=.08,z_index_dv_img_box=999,vopa_img_box,idpopup_img_box;const DOCS_RE=/\!\[\]\([a-zA-Z0-9.\/_-]*\)/g,modal=()=>{document.addEventListener("DOMContentLoaded",function(e){$("#form-modal").on("show.bs.modal",function(o){var t=$(o.relatedTarget),i=t.data("attacknumber"),a=t.data("start"),n=parseInt(t.data("off")),r=parseInt(t.data("leftoff")),l=parseInt(t.data("nobleman")),s=parseInt(t.data("leftnobleman")),m=parseInt(t.data("catapult")),c=parseInt(t.data("leftcatapult")),u=t.data("id"),d=$(this),f=n-m*8,p=m,b=r-c*8,h=c,v=f+b,y=p+h;d.find(".modal-title").text(a),d.find("#attack-number").text(i),d.find("#id_weight_id").val(u),d.find("#id_off").val(n),d.find("#id_off_no_catapult").val(f),d.find("#id_off_no_catapult").attr("max",v),d.find("#hint_id_off_no_catapult").text(`0-${v}`),d.find("#id_off_no_catapult").change(function(){var _=parseInt(d.find("#id_catapult").val()),g=parseInt(d.find("#id_off_no_catapult").val());d.find("#id_off").val(g+_*8)}),d.find("#id_catapult").val(p),d.find("#id_catapult").attr("max",y),d.find("#hint_id_catapult").text(`0-${y}`),d.find("#id_catapult").change(function(){var _=parseInt(d.find("#id_catapult").val()),g=parseInt(d.find("#id_off_no_catapult").val());d.find("#id_off").val(g+_*8)}),d.find("#id_nobleman").val(l),d.find("#id_nobleman").attr("max",l+s),d.find("#hint_id_nobleman").text(`0-${l+s}`)}),$(".popoverData").popover(),$(".popoverOption").popover({trigger:"hover"})})},isLocalhost=()=>location.hostname==="localhost"||location.hostname==="127.0.0.1",getLanguage=()=>{const e=location.pathname.split("/");try{return e[1]}catch(o){return console.error(o),"en"}},loadDocsPage=(e,o,t,i=!1)=>{const a=document.getElementById(o),n=`/static/markdown/${getLanguage()}`;localStorage.getItem(t)!==null&&!isLocalhost()?a.innerHTML=marked.parse(localStorage.getItem(t)):fetch(t).then(r=>r.text()).then(r=>{const l=[...r.matchAll(DOCS_RE)];for(const s of l){const m=s[0];let c=m.slice(4,-1);c=`${n}/${c}`;const u=`<img id="large" class="img-thumbnail" style="height: 250px;" onclick="img_box(this)" src="${c}">`;r=r.replaceAll(m,u)}return r}).then(r=>{localStorage.getItem(String(e))!=null&&localStorage.removeItem(localStorage.getItem(String(e))),document.getElementById(o).innerHTML=marked.parse(r),isLocalhost()||(localStorage.setItem(t,r),localStorage.setItem(String(e),t))}).then(()=>{const r=new URLSearchParams(location.search);location.hash!==""?setTimeout(()=>{localStorage.setItem(`${e}-scroll-id`,String(document.getElementById(location.hash.slice(1)).offsetTop)),location.search=""},300):i&&wholePageContentScroll(`${e}-scroll-id`)})},wholePageContentScroll=e=>{localStorage.getItem(e)!=null&&$(window).scrollTop(localStorage.getItem(e)),$(window).on("scroll",function(){localStorage.setItem(e,$(window).scrollTop())})},scroll_content_outline=()=>{$(window).on("load",function(){localStorage.getItem("my_app_name_here-quote-scroll")!=null&&$(window).scrollTop(localStorage.getItem("my_app_name_here-quote-scroll")),localStorage.getItem("my_app_name_here-left-scroll")!=null&&$("#leftscroll").scrollTop(localStorage.getItem("my_app_name_here-left-scroll")),$(window).on("scroll",function(){localStorage.setItem("my_app_name_here-quote-scroll",$(window).scrollTop())}),$("#leftscroll").on("scroll",function(){var e=$("#leftscroll").scrollTop();localStorage.setItem("my_app_name_here-left-scroll",e)})})},menu_toggle=()=>{$("#menu-toggle").click(function(e){e.preventDefault(),$("#sidebar-wrapper").toggleClass("toggled")}),$(document).ready(function(){$("#id_date").addClass("data-picker"),$(".data-picker").datepicker({format:"yyyy-mm-dd",weekStart:1,language:getLanguage(),todayHighlight:!0})})},prettifyTimeDistance=e=>{e=Math.round(e);const o=Math.floor(e/3600);e%=3600;const t=Math.floor(e/60),i=e%60;let a=o.toString(),n=t.toString(),r=i.toString();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),`${a}:${n}:${r}`},calculate_distance=e=>{const o=parseFloat(String(document.getElementById("speed_world").value)),t=parseFloat(String(document.getElementById("speed_units").value));let i=parseFloat(e.dataset.distance);if(e.clicked)e.innerText=String(i.toFixed(1)),e.clicked=!1,e.style.cursor="zoom-in";else{let a=i/t/o*30*60,n=i/t/o*35*60;e.innerHTML=`<span class='text-nowrap'>${prettifyTimeDistance(a)} /<br/> ${prettifyTimeDistance(n)}</span>`,e.clicked=!0,e.style.cursor="zoom-out"}},activateTooltips=()=>{document.addEventListener("DOMContentLoaded",function(e){$(".popoverData").popover()}),$(function(){$('[data-toggle="tooltip"]').tooltip()})},onPlanerLinkClick=e=>{setTimeout(()=>{const o=document.getElementById("planer-link");o.innerHTML=`<span class='spinner-border mr-1 spinner-border-sm text-info my-auto' role='status'></span>${e}`},800)},handleAllFormsetSelect=()=>{document.addEventListener("DOMContentLoaded",function(e){val=$("#id_form-0-status").val(),val==="all"?($("#id_form-0-from_number").val(""),$("#id_form-0-from_number").prop("disabled",!0),$("#id_form-0-to_number").val(""),$("#id_form-0-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-0-from_number").val(""),$("#id_form-0-from_number").prop("disabled",!0),$("#id_form-0-to_number").prop("disabled",!1)),val=$("#id_form-1-status").val(),val==="all"?($("#id_form-1-from_number").val(""),$("#id_form-1-from_number").prop("disabled",!0),$("#id_form-1-to_number").val(""),$("#id_form-1-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-1-from_number").val(""),$("#id_form-1-from_number").prop("disabled",!0),$("#id_form-1-to_number").prop("disabled",!1)),val=$("#id_form-2-status").val(),val==="all"?($("#id_form-2-from_number").val(""),$("#id_form-2-from_number").prop("disabled",!0),$("#id_form-2-to_number").val(""),$("#id_form-2-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-2-from_number").val(""),$("#id_form-2-from_number").prop("disabled",!0),$("#id_form-2-to_number").prop("disabled",!1)),val=$("#id_form-3-status").val(),val==="all"?($("#id_form-3-from_number").val(""),$("#id_form-3-from_number").prop("disabled",!0),$("#id_form-3-to_number").val(""),$("#id_form-3-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-3-from_number").val(""),$("#id_form-3-from_number").prop("disabled",!0),$("#id_form-3-to_number").prop("disabled",!1)),val=$("#id_form-4-status").val(),val==="all"?($("#id_form-4-from_number").val(""),$("#id_form-4-from_number").prop("disabled",!0),$("#id_form-4-to_number").val(""),$("#id_form-4-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-4-from_number").val(""),$("#id_form-4-from_number").prop("disabled",!0),$("#id_form-4-to_number").prop("disabled",!1)),val=$("#id_form-5-status").val(),val==="all"?($("#id_form-5-from_number").val(""),$("#id_form-5-from_number").prop("disabled",!0),$("#id_form-5-to_number").val(""),$("#id_form-5-to_number").prop("disabled",!0)):val==="exact"&&($("#id_form-5-from_number").val(""),$("#id_form-5-from_number").prop("disabled",!0),$("#id_form-5-to_number").prop("disabled",!1))}),document.addEventListener("DOMContentLoaded",function(e){$(".time-timepicker").each(function(){$(this).timepicker({minuteStep:1,secondStep:1,showSeconds:!0,showMeridian:!1,defaultTime:!1,icons:{up:"fa fa-angle-up",down:"fa fa-angle-down"}})}),$("#id_form-0-status").change(function(){val=$("#id_form-0-status").val(),val==="all"?($("#id_form-0-from_number").val(""),$("#id_form-0-from_number").prop("disabled",!0),$("#id_form-0-to_number").val(""),$("#id_form-0-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-0-from_number").val(""),$("#id_form-0-from_number").prop("disabled",!0),$("#id_form-0-to_number").prop("disabled",!1)):($("#id_form-0-from_number").prop("disabled",!1),$("#id_form-0-to_number").prop("disabled",!1))}),$("#id_form-1-status").change(function(){val=$("#id_form-1-status").val(),val==="all"?($("#id_form-1-from_number").val(""),$("#id_form-1-from_number").prop("disabled",!0),$("#id_form-1-to_number").val(""),$("#id_form-1-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-1-from_number").val(""),$("#id_form-1-from_number").prop("disabled",!0),$("#id_form-1-to_number").prop("disabled",!1)):($("#id_form-1-from_number").prop("disabled",!1),$("#id_form-1-to_number").prop("disabled",!1))}),$("#id_form-2-status").change(function(){val=$("#id_form-2-status").val(),val==="all"?($("#id_form-2-from_number").val(""),$("#id_form-2-from_number").prop("disabled",!0),$("#id_form-2-to_number").val(""),$("#id_form-2-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-2-from_number").val(""),$("#id_form-2-from_number").prop("disabled",!0),$("#id_form-2-to_number").prop("disabled",!1)):($("#id_form-2-from_number").prop("disabled",!1),$("#id_form-2-to_number").prop("disabled",!1))}),$("#id_form-3-status").change(function(){val=$("#id_form-3-status").val(),val==="all"?($("#id_form-3-from_number").val(""),$("#id_form-3-from_number").prop("disabled",!0),$("#id_form-3-to_number").val(""),$("#id_form-3-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-3-from_number").val(""),$("#id_form-3-from_number").prop("disabled",!0),$("#id_form-3-to_number").prop("disabled",!1)):($("#id_form-3-from_number").prop("disabled",!1),$("#id_form-3-to_number").prop("disabled",!1))}),$("#id_form-4-status").change(function(){val=$("#id_form-4-status").val(),val==="all"?($("#id_form-4-from_number").val(""),$("#id_form-4-from_number").prop("disabled",!0),$("#id_form-4-to_number").val(""),$("#id_form-4-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-4-from_number").val(""),$("#id_form-4-from_number").prop("disabled",!0),$("#id_form-4-to_number").prop("disabled",!1)):($("#id_form-4-from_number").prop("disabled",!1),$("#id_form-4-to_number").prop("disabled",!1))}),$("#id_form-5-status").change(function(){val=$("#id_form-5-status").val(),val==="all"?($("#id_form-5-from_number").val(""),$("#id_form-5-from_number").prop("disabled",!0),$("#id_form-5-to_number").val(""),$("#id_form-5-to_number").prop("disabled",!0)):val==="exact"?($("#id_form-5-from_number").val(""),$("#id_form-5-from_number").prop("disabled",!0),$("#id_form-5-to_number").prop("disabled",!1)):($("#id_form-5-from_number").prop("disabled",!1),$("#id_form-5-to_number").prop("disabled",!1))})})},handleClickButton=(e,o,t,i="",a=!1)=>{const n=document.getElementsByTagName("button"),r=document.getElementsByTagName("a");if(a){for(const l of n)l.disabled=!0;for(const l of r)l.classList.add("disabled-link")}e.disabled=!0,e.innerHTML=`<span class='spinner-border mr-1 spinner-border-sm text-dark my-auto' role='status'></span> ${o} <span id=${i}></span>`;try{document.getElementById(t).submit()}catch(l){if(console.error(l),e.disabled=!1,a){for(const s of n)s.disabled=!1;for(const s of r)s.classList.remove("disabled-link")}}};function getCookie(e){var o=null;if(document.cookie&&document.cookie!="")for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var a=jQuery.trim(t[i]);if(a.substring(0,e.length+1)==e+"="){o=decodeURIComponent(a.substring(e.length+1));break}}return o}const changeTargetTime=async(e,o)=>{const t=parseInt(e),i=parseInt(o),a=String(e)+"-time-"+String(o),n=document.getElementById(a),r=n.innerHTML;n.innerHTML='<div class="spinner-border spinner-border-sm text-secondary" role="status"></div>';const l=await fetch("/api/target-time-update/",{method:"PUT",credentials:"same-origin",body:JSON.stringify({target_id:t,time_id:i}),headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"}});if(l.status!==200){n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg>';const s=n.className;n.className="btn btn-lg btn-danger my-1 py-0 px-1 mr-1",setTimeout(()=>{n.className=s,n.innerHTML=r,n.blur()},2e3)}else{const s=await l.json();if(n.className="btn btn-lg btn-primary my-1 py-0 px-1 mr-1",n.innerHTML=r,n.blur(),s.old!=="none"&&s.old!==s.new){const m=document.getElementById(s.old);m.className="btn btn-lg btn-light my-1 py-0 px-1 mr-1"}}},deleteTarget=async e=>{const o=parseInt(e),t="target-btn-"+String(e),i="target-row-"+String(e),a=document.getElementById(t),n=document.getElementById(i),r=a.innerHTML;a.disabled=!0,a.innerHTML='<div class="spinner-border spinner-border-sm text-secondary" role="status"></div>',(await fetch("/api/target-delete/",{method:"DELETE",credentials:"same-origin",body:JSON.stringify({target_id:o}),headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"}})).status!==204?(a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg>',setTimeout(()=>{a.innerHTML=r,a.blur()},2e3)):n.style.display="none"},handlePlanerMenuVisibilityChange=()=>{document.hidden?tabPlanerMenuHasBeenHidden=!0:tabPlanerMenuHasBeenHidden&&window.location.reload()},changeIsHiddenState=async(e,o)=>{const t=document.getElementById(o),i=t.innerHTML;t.disabled=!0,t.innerHTML='<div class="spinner-border spinner-border-sm text-secondary" role="status"></div>';const a=await fetch("/api/overview-hide-state-update/",{method:"PUT",credentials:"same-origin",body:JSON.stringify({outline_id:e,token:o}),headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"}});if(a.status!==200)t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg>',setTimeout(()=>{t.innerHTML=i,t.blur()},2e3);else{const n=await a.json();t.innerHTML=n.name,t.className=n.class,t.disabled=!1,t.blur()}},changeBuildingsArray=async(e,o)=>{const t=document.getElementById("multi-select-spinner");t.innerHTML='<div class="spinner-border spinner-border-sm text-secondary" role="status"></div>';const i={buildings:o,outline_id:e};await fetch("/api/change-buildings-array/",{method:"PUT",credentials:"same-origin",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then(a=>{a.status===200?(t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="green" class="bi bi-check" viewBox="0 0 16 16"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/></svg>',setTimeout(()=>{t.innerHTML=""},400)):(t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg> <span class="md-error">(Error in connection!)</span>',setTimeout(()=>{t.innerHTML=""},2e3))}).catch(()=>{t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg> <span class="md-error">(Error in connection!)</span>',setTimeout(()=>{t.innerHTML=""},2e3)})},resetUserMessages=async()=>{const e=document.getElementById("reset-svg"),o=document.getElementById("reset-span");await fetch("/api/reset-user-messages/",{method:"PUT",credentials:"same-origin",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>{t.status===200&&(e.style.fill="rgba(0,0,0,.5)",o.style.color="rgba(0,0,0,.5)",o.innerHTML="0")})},codemirrorValidation=(e,o)=>{document.addEventListener("DOMContentLoaded",function(t){$(o).addClass("CodeMirror-Invalid");const a=$(o)[0].CodeMirror,n=JSON.parse(e);Object.entries(n).forEach(([r,l],s)=>{s===0&&a.scrollIntoView(parseInt(l.message)),a.addLineClass(parseInt(l.message),"wrap","line-error")})})},handleButtonClipboardUpdate=(e,o,t,i,a)=>{const n=document.getElementById(o),r=e.innerHTML;setTimeout(()=>{e.blur()},100);try{const l=n.textContent;navigator.clipboard.writeText(l),e.innerHTML=`<i class="bi bi-check2-circle" style="color: green"></i> ${t}`,setTimeout(()=>{e.innerHTML=`<i class="bi bi-arrow-counterclockwise"></i> ${i}`},1800)}catch(l){console.error(l),e.innerHTML=`<span style="color: red"><i class="bi bi-x-circle"></i> ${a}</span>`,setTimeout(()=>{e.innerHTML=r},5e3)}},copyDataToClipboard=(e,o,t)=>{const i=t?document.getElementById(o).value:document.getElementById(o).textContent;navigator.clipboard.writeText(i),e.blur();const a=e.innerHTML;e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="green" class="bi bi-check2-all" viewBox="0 0 16 16"><path d="M12.354 4.354a.5.5 0 0 0-.708-.708L5 10.293 1.854 7.146a.5.5 0 1 0-.708.708l3.5 3.5a.5.5 0 0 0 .708 0l7-7zm-4.208 7l-.896-.897.707-.707.543.543 6.646-6.647a.5.5 0 0 1 .708.708l-7 7a.5.5 0 0 1-.708 0z"/><path d="M5.354 7.146l.896.897-.707.707-.897-.896a.5.5 0 1 1 .708-.708z"/></svg>',setTimeout(()=>{e.innerHTML=a},600)},removeOutline=(e,o,t,i)=>{const a=document.getElementById(o),n=document.getElementById(t);e.disabled=!0,e.innerHTML=`<span class='spinner-border mr-1 spinner-border-sm text-dark my-auto' role='status'></span> ${i}`,a.disabled=!0,n.submit()},imagePopupActivate=()=>{window.onload=function(){var e=document.createElement("div");e.id="img_box",document.getElementsByTagName("body")[0].appendChild(e),idpopup_img_box=document.getElementById("img_box"),idpopup_img_box.style.top=0,idpopup_img_box.style.left=0,idpopup_img_box.style.opacity=0,idpopup_img_box.style.width="100%",idpopup_img_box.style.height="100%",idpopup_img_box.style.display="none",idpopup_img_box.style.position="fixed",idpopup_img_box.style.cursor="pointer",idpopup_img_box.style.textAlign="center",idpopup_img_box.style.zIndex=z_index_dv_img_box,idpopup_img_box.style.backgroundColor=bg_color_img_box}},img_box=e=>{var o=typeof e=="string"?e:e.src;vopa_img_box=0;var t=window.innerHeight,i=window.innerWidth,a,n,r,l=new Image;l.src=o,l.onload=function(){a=l.height,wimg_img_box=l.width,idpopup_img_box.innerHTML="<img src="+o+">",wimg_img_box>i?idpopup_img_box.getElementsByTagName("img")[0].style.width="90%":a>t&&(idpopup_img_box.getElementsByTagName("img")[0].style.height="90%",a=t*90/100),a<t?(n=t/2-a/2,idpopup_img_box.style.paddingTop=n+"px"):idpopup_img_box.style.paddingTop="0px",allow_hide_scroll_img_box=="yes"&&(document.body.style.overflow="hidden"),idpopup_img_box.style.display="block"},use_fade_inout_img_box=="yes"?r=setInterval(function(){vopa_img_box<=1.1?(idpopup_img_box.style.opacity=vopa_img_box,vopa_img_box+=speed_img_box):(idpopup_img_box.style.opacity=1,clearInterval(r))},10):idpopup_img_box.style.opacity=1,window.onkeyup=function(s){if(s.keyCode==27)if(use_fade_inout_img_box=="yes")var m=setInterval(function(){vopa_img_box>=0?(idpopup_img_box.style.opacity=vopa_img_box,vopa_img_box-=speed_img_box):(idpopup_img_box.style.opacity=0,clearInterval(m),idpopup_img_box.style.display="none",idpopup_img_box.innerHTML="",document.body.style.overflow="visible",vopa_img_box=0)},10);else idpopup_img_box.style.opacity=0,idpopup_img_box.style.display="none",idpopup_img_box.innerHTML="",document.body.style.overflow="visible"},idpopup_img_box.onclick=function(){if(use_fade_inout_img_box=="yes")var s=setInterval(function(){vopa_img_box>=0?(idpopup_img_box.style.opacity=vopa_img_box,vopa_img_box-=speed_img_box):(idpopup_img_box.style.opacity=0,clearInterval(s),idpopup_img_box.style.display="none",idpopup_img_box.innerHTML="",document.body.style.overflow="visible",vopa_img_box=0)},10);else idpopup_img_box.style.opacity=0,idpopup_img_box.style.display="none",idpopup_img_box.innerHTML="",document.body.style.overflow="visible"}},updateClipboard=e=>{const o=document.getElementById(e).textContent;navigator.clipboard.writeText(o)},updateAfterClick=async(e,o,t)=>{const i=Number.parseFloat(o)/100;let a=0;const n=setInterval(()=>{a+=1,e.innerHTML=t+` ${a}%`,a===99&&clearInterval(n)},i)},createBuildingsOptions=(e,o,t,i,a,n,r,l,s,m,c,u,d,f,p,b)=>[{label:e,value:"headquarters"},{label:o,value:"barracks"},{label:t,value:"stable"},{label:i,value:"workshop"},{label:a,value:"academy"},{label:n,value:"smithy"},{label:r,value:"rally_point"},{label:l,value:"statue"},{label:s,value:"market"},{label:m,value:"timber_camp"},{label:c,value:"clay_pit"},{label:u,value:"iron_mine"},{label:d,value:"farm"},{label:f,value:"warehouse"},{label:p,value:"wall"},{label:b,value:"watchtower"}],changeTextToSent=(e,o)=>{e.innerHTML=`${o}`},fillAndSubmit=e=>{const o=document.getElementById("create-form"),t=document.getElementsByName("target_type")[0];t.value=e,o.submit()},initializePaymentProcess=async(e,o)=>{const t=document.getElementById("payment-button");t.disabled=!0;const i=await(await fetch("/api/stripe-key/")).json(),a=Stripe(i.publicKey);t.onclick=()=>{const n=t.innerHTML;t.innerHTML="<span class='spinner-border mr-1 spinner-border-sm text-info my-auto' role='status'></span>",fetch("/api/stripe-session/",{method:"POST",credentials:"same-origin",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({amount:parseInt(e),currency:o})}).then(r=>{if(r.status===200)return r.json();if(r.status===400)t.innerHTML=n,r.json().then(l=>{throw console.error(l),alert(`Something went wrong. Message: ${l.error}`),l.error});else throw t.innerHTML=n,console.error(r),alert("Something went wrong. unknown error"),"unknown error"}).then(r=>{console.log(r),window.location.href=r.url})},t.disabled=!1},resetBackgroundBuildingsColors=e=>{document.getElementById("headquarters-"+e).classList.remove("fancy-building-True"),document.getElementById("smithy-"+e).classList.remove("fancy-building-True"),document.getElementById("timber_camp-"+e).classList.remove("fancy-building-True"),document.getElementById("clay_pit-"+e).classList.remove("fancy-building-True"),document.getElementById("farm-"+e).classList.remove("fancy-building-True"),document.getElementById("warehouse-"+e).classList.remove("fancy-building-True")},changeWeightBuildingDirect=async(e,o)=>{const t=e.id,[i,a]=t.split("-");resetBackgroundBuildingsColors(a),e.classList.add("fancy-building-True");const n=document.getElementById("building-name-"+a);n.innerHTML='<div class="spinner-border spinner-border-sm text-secondary" role="status"></div>';const r=await fetch("/api/change-weight-building/",{method:"PUT",credentials:"same-origin",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({building:i,outline_id:o,weight_id:a})});if(r.status!==200)n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg>',setTimeout(()=>{n.innerHTML="Try again"},2e3);else{const l=await r.json();n.innerHTML=`<b>${l.name}</b>`}},activateTimezoneInfo=()=>{let e=Intl.DateTimeFormat().resolvedOptions().timeZone;e||(e="UTC"),document.cookie="mytz="+e+";path=/"},setFooterYears=()=>{const e=document.getElementById("footer-years");e.innerText=`2020-${new Date().getFullYear()} `},setupDataTable=e=>{const o={};getLanguage()==="pl"&&(o.language={url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/pl.json"}),new DataTable(e,o)};
